
<div class ="container">
 <h2 class ="mt-3 text-dark bg-light">投稿編集</h2>

 <div class ="mt-4">
    <% if @post.errors.any? %>
     <ul class ="alert alert-danger" role ="alert">
      <h6 class ="alert-heading">
       <%= @post.errors.count %>件のエラーが発生しました
      </h6>
      <%= @post.errors.full_messages.each do |message| %>
       <li><%= message %></li>
      <% end %>
     </ul>
    <% end %>

    <%= form_with model: @post, url: post_path(@post.id), method: :patch do |f| %>
     <div class ="field">
      <%= f.label :image, "画像", class: "col-lg-3 offset-lg-1" %>
      <%= f.file_field :image, accept: "image/*" %>
     </div>
     <div class ="field">
      <%= f.label :title, "タイトル", class: "col-lg-3 offset-lg-1" %>
      <%= f.text_field :title, autofocus: true, autocomplete: "title", size: "40" %>
     </div>
     <div class ="field">
      <%= f.label :body, "概要", class: "col-lg-3 offset-lg-1" %>
      <%= f.text_area :body, size: "40x5" %>
     </div>
     <div class ="field">
      <%= f.label :postal_code, "郵便番号(ハイフンなし)", class: "col-lg-3 offset-lg-1" %>
      <%= f.text_field :postal_code, autocomplete: "postal_code" %>
     </div>
     <div class ="field">
      <%= f.label :address, "住所", class: "col-lg-3 offset-lg-1" %>
      <%= f.text_field :address, autocomplete: "address", size: "40" %>
     </div>
     <div class ="field">
      <%= f.label :tag_ids, "タグ", class: "col-lg-3 offset-lg-1" %>
      <%#= f.collection_select(:tag_ids, Tag.where(status: false), :id, :name) %>
      <%= f.collection_check_boxes :tag_ids, Tag.where(status: false), :id, :name, include_hidden: false do |tag| %>
       <%= tag.label {tag.check_box + tag.text }%>
      <% end %>
     </div>

     <div class ="field">
      <%= f.label :rate, "評価", class: "col-lg-3 offset-lg-1" %>
      <span id= "edit_star"></span>
     </div>

     <div class ="actions">
      <% if @post.is_draft == true %>
       <%= f.submit "投稿する", :name => 'go_draft', class: "btn btn-success offset-lg-4" %>
       <%= f.submit "変更を保存", :name => 'update_draft', class: "btn btn-secondary" %>
      <% else %>
       <%= f.submit "変更を保存", :name => 'update_post', class: "btn btn-success offset-lg-4" %>
      <% end %>
     </div>
    <% end %>


  </div>

 </div>
</div>

<script>
       var edit_elem = document.querySelector('#edit_star');
         // scriptファイルをどのidの部分に配置するかを指定
       var edit_opt = {
        starOn: "<%= asset_path('star-on.png') %>",
        starOff: "<%= asset_path('star-off.png') %>",
        starHalf: "<%= asset_path('star-half.png') %>",
        readOnly: false,
        half: true,
        score: <%= @post.rate %>,
        scoreName: "post[rate]"
         //星画像の指定などのオプションをここに記述,
        };
      raty(edit_elem,edit_opt);
        //application.jsの20行目のratyを使用している
</script>